<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bussola Interattiva per Azimuth</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
      @import url('https://rsms.me/inter/inter.css');
      
      .compass-container {
        touch-action: none;
        cursor: default;
      }
      .draggable-target {
        cursor: grab;
      }
      .draggable-target:active,
      .draggable-target.dragging {
        cursor: grabbing;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-900 text-white">

  <div class="min-h-screen bg-gray-900 text-gray-100 flex flex-col items-center p-4 sm:p-6 lg:p-8">
    
    <header class="text-center">
      <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-white">
        <span class="text-cyan-400">Bussola Interattiva</span>: Impara l'Azimuth
      </h1>
      <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-400">
        Scopri cos'è l'azimuth e come viene calcolato. Trascina il bersaglio sulla bussola per vedere come cambia l'angolo dal Nord.
      </p>
    </header>

    <main class="w-full max-w-7xl flex flex-col lg:flex-row items-center justify-center gap-8 lg:gap-16 mt-8">
      
      <div class="w-full lg:w-1/2 flex justify-center">
        <div id="compass" class="relative rounded-full bg-slate-800 border-4 border-slate-700 shadow-2xl flex items-center justify-center compass-container" style="width: 350px; height: 350px;">
          <div class="absolute w-full h-full rounded-full bg-slate-900" style="transform: scale(0.95)"></div>
          <div id="markings-container"></div>
          
          <span class="absolute top-4 text-2xl font-bold text-red-500">N</span>
          <span class="absolute bottom-4 text-xl font-semibold text-slate-300">S</span>
          <span class="absolute left-4 text-xl font-semibold text-slate-300">W</span>
          <span class="absolute right-4 text-xl font-semibold text-slate-300">E</span>
          
          <div class="w-4 h-4 bg-cyan-400 rounded-full border-2 border-slate-900 z-10"></div>

          <div id="azimuth-line" class="absolute top-1/2 left-1/2 origin-left bg-red-500/50 z-20" style="height: 3px; border-radius: 2px;"></div>

          <div id="target" class="absolute w-8 h-8 rounded-full bg-red-500 border-4 border-white shadow-lg flex items-center justify-center z-30 draggable-target" style="transform: translate(-50%, -50%)"></div>
        </div>
      </div>

      <div class="w-full lg:w-1/2 flex flex-col items-center lg:items-start">
        <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl border border-slate-700 w-full max-w-md">
          <h2 class="text-3xl font-bold text-cyan-400 mb-4 text-center lg:text-left">
            Azimuth Corrente
          </h2>
          <div class="text-center bg-slate-900 rounded-lg p-6 mb-6">
            <span id="azimuth-display" class="text-6xl font-mono font-bold text-white tracking-wider">
              45°
            </span>
          </div>
          
          <div class="space-y-4 text-slate-300">
            <div>
              <h3 class="font-semibold text-lg text-white">Cos'è l'Azimuth?</h3>
              <p class="mt-1">
                L'azimuth è un angolo di direzione orizzontale misurato in gradi, in senso orario, a partire da un punto di riferimento fisso. In navigazione, questo riferimento è quasi sempre il <strong class="text-red-400">Nord geografico (0°)</strong>.
              </p>
            </div>
            <div>
              <h3 class="font-semibold text-lg text-white">Interpretazione</h3>
              <p class="mt-1">
                Il tuo bersaglio si trova a <strong id="azimuth-explanation" class="text-cyan-400">45°</strong>.
                Questo significa che la sua direzione è verso <strong id="cardinal-direction" class="text-cyan-400">Nord-Est</strong>.
              </p>
              <ul class="list-disc list-inside mt-2 space-y-1 text-slate-400">
                <li>Un azimuth di <strong class="text-white">90°</strong> corrisponde a <strong class="text-white">Est</strong>.</li>
                <li>Un azimuth di <strong class="text-white">180°</strong> corrisponde a <strong class="text-white">Sud</strong>.</li>
                <li>Un azimuth di <strong class="text-white">270°</strong> corrisponde a <strong class="text-white">Ovest</strong>.</li>
                <li>Un azimuth di <strong class="text-white">360°</strong> o <strong class="text-white">0°</strong> corrisponde a <strong class="text-white">Nord</strong>.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </main>
    
    <footer class="mt-12 text-center text-slate-500">
      <p>Creato per scopi didattici. Trascina il punto rosso per interagire.</p>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const compass = document.getElementById('compass');
      const target = document.getElementById('target');
      const azimuthLine = document.getElementById('azimuth-line');
      const azimuthDisplay = document.getElementById('azimuth-display');
      const azimuthExplanation = document.getElementById('azimuth-explanation');
      const cardinalDirectionDisplay = document.getElementById('cardinal-direction');
      const markingsContainer = document.getElementById('markings-container');

      const size = 350;
      const radius = size / 2 * 0.8;
      let azimuth = 45;

      const getCardinalDirection = (angle) => {
        if (angle > 337.5 || angle <= 22.5) return "Nord";
        if (angle > 22.5 && angle <= 67.5) return "Nord-Est";
        if (angle > 67.5 && angle <= 112.5) return "Est";
        if (angle > 112.5 && angle <= 157.5) return "Sud-Est";
        if (angle > 157.5 && angle <= 202.5) return "Sud";
        if (angle > 202.5 && angle <= 247.5) return "Sud-Ovest";
        if (angle > 247.5 && angle <= 292.5) return "Ovest";
        if (angle > 292.5 && angle <= 337.5) return "Nord-Ovest";
        return "";
      };

      const updateUI = (newAzimuth) => {
        azimuth = newAzimuth;

        const targetAngleRad = (azimuth - 90) * (Math.PI / 180);
        const targetX = (size / 2) + radius * Math.cos(targetAngleRad);
        const targetY = (size / 2) + radius * Math.sin(targetAngleRad);
        target.style.left = `${targetX}px`;
        target.style.top = `${targetY}px`;

        azimuthLine.style.transform = `rotate(${azimuth - 90}deg)`;
        azimuthLine.style.width = `${radius}px`;

        const azimuthInt = Math.round(azimuth);
        azimuthDisplay.textContent = `${azimuthInt}°`;
        azimuthExplanation.textContent = `${azimuthInt}°`;
        cardinalDirectionDisplay.textContent = getCardinalDirection(azimuth);
      };

      const handleInteraction = (clientX, clientY) => {
        if (!compass) return;
        const rect = compass.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        
        const deltaX = clientX - centerX;
        const deltaY = clientY - centerY;

        const angleRad = Math.atan2(deltaY, deltaX);
        const angleDeg = angleRad * (180 / Math.PI);

        const newAzimuth = (angleDeg + 90 + 360) % 360;
        updateUI(newAzimuth);
      };

      const onMouseMove = (e) => handleInteraction(e.clientX, e.clientY);
      
      const onTouchMove = (e) => {
        e.preventDefault();
        handleInteraction(e.touches[0].clientX, e.touches[0].clientY);
      };

      const stopDragging = () => {
        target.classList.remove('dragging');
        window.removeEventListener('mousemove', onMouseMove);
        window.removeEventListener('mouseup', stopDragging);
        window.removeEventListener('touchmove', onTouchMove);
        window.removeEventListener('touchend', stopDragging);
      };
      
      const startDragging = (e) => {
        e.preventDefault();
        target.classList.add('dragging');
        
        if (e.type === 'mousedown') {
            handleInteraction(e.clientX, e.clientY);
            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', stopDragging);
        } else if (e.type === 'touchstart') {
            handleInteraction(e.touches[0].clientX, e.touches[0].clientY);
            window.addEventListener('touchmove', onTouchMove, { passive: false });
            window.addEventListener('touchend', stopDragging);
        }
      };

      const renderMarkings = () => {
          for (let i = 0; i < 360; i += 10) {
              const isCardinal = i % 90 === 0;
              const isSubCardinal = i % 30 === 0;
              const length = isCardinal ? 15 : (isSubCardinal ? 10 : 5);
              const color = isCardinal ? 'white' : 'rgb(100 116 139)'; // slate-500
              
              const mark = document.createElement('div');
              mark.className = "absolute top-1/2 left-1/2 origin-left";
              mark.style.transform = `rotate(${i}deg) translateX(${size/2 - 20}px)`;
              mark.style.width = `${length}px`;
              mark.style.height = '2px';
              mark.style.backgroundColor = color;
              markingsContainer.appendChild(mark);
          }
      };
      
      target.addEventListener('mousedown', startDragging);
      target.addEventListener('touchstart', startDragging, { passive: false });
      
      renderMarkings();
      updateUI(azimuth);
    });
  </script>
</body>
</html>
